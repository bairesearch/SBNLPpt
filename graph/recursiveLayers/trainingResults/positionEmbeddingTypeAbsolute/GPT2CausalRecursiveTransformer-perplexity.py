import matplotlib.pyplot as plt
import numpy as np

x = np.array([0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4])
y1 = np.array([25.0, 16.17632293701172, 12.893939971923828, 11.613675117492676, 10.887641906738281, 10.431144714355469, 10.097999572753906, 9.906881332397461, 9.716487884521484])
y2 = np.array([25.0, 8.46451473236084, 6.351888179779053, 5.609471321105957, 5.203763008117676, 4.954327583312988, 4.783695220947266, 4.655602931976318, 4.573307037353516])
y3 = np.array([25.0, 11.413861274719238, 8.91283893585205, 8.011733055114746, 7.461851596832275, 7.120016574859619, 6.929925918579102, 6.687497615814209, 6.60063362121582])
y4 = np.array([25.0, 9.152446746826172, 6.939035415649414, 6.026368618011475, 5.572467803955078, 5.327277660369873, 5.085224628448486, 4.990666389465332, 4.87790060043335])
y5 = np.array([25.0, 12.556459426879883, 9.637907981872559, 8.600414276123047, 7.9620747566223145, 7.568157196044922, 7.2569403648376465, 7.113116264343262, 6.962826728820801])

l1, = plt.plot(x, y1, color='green', label='lay=1, hid=768, head=12 (176MB)')
l2, = plt.plot(x, y2, color='blue', label='lay=12, hid=768, head=12 (486MB)')
l3, = plt.plot(x, y3, color='red', label='lay=1r12, hid=768, head=12 (176MB)')
l4, = plt.plot(x, y4, color='pink', label='lay=1r12, hid=1792, head=28 (norm:496MB)')
l5, = plt.plot(x, y5, color='lightgreen', label='lay=1, hid=768, head=24 (norm:407MB)')

plt.xticks(np.arange(min(x), max(x)+0.5, 0.5))
plt.yticks(np.arange(0, 25.0+2.0, 2.0))

plt.xlabel("number of codeparrot-ds train samples (x1280000)")
plt.ylabel("Causal LM test perplexity")
plt.title("GPT2 Recursive Transformer")

plt.legend(handles=[l2, l3, l4, l1, l5])

plt.show()
